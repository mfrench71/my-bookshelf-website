---
layout: base.njk
title: Book Details
scripts: '<script type="module" src="/js/books/view.js"></script>'
---

<!-- Sub-navigation -->
<div class="bg-white border-b border-gray-200 sticky top-14 z-30">
  <div class="max-w-6xl mx-auto px-4 py-2 flex items-center justify-between">
    <nav aria-label="Breadcrumb">
      <ol id="breadcrumb" class="flex items-center text-sm"></ol>
    </nav>
    <div class="flex items-center gap-1">
      <a
        id="edit-btn"
        href="#"
        class="p-2 hover:bg-gray-100 rounded-lg text-gray-600 flex items-center justify-center sm:justify-start gap-1 min-h-[44px] min-w-[44px]"
        aria-label="Edit book"
      >
        <i data-lucide="pencil" class="w-5 h-5" aria-hidden="true"></i>
        <span class="text-sm hidden sm:inline">Edit</span>
      </a>
      <button
        id="delete-btn"
        class="p-2 hover:bg-red-50 rounded-lg text-red-600 flex items-center justify-center sm:justify-start gap-1 min-h-[44px] min-w-[44px]"
        aria-label="Delete book"
      >
        <i data-lucide="trash-2" class="w-5 h-5" aria-hidden="true"></i>
        <span class="text-sm hidden sm:inline">Delete</span>
      </button>
    </div>
  </div>
</div>

<!-- Loading (Skeleton) -->
<div id="loading" class="max-w-6xl mx-auto px-4 py-6">
  <div class="flex flex-col md:flex-row md:gap-8">
    <!-- Cover Skeleton -->
    <div class="md:w-72 flex-shrink-0 mb-6 md:mb-0">
      <div class="skeleton aspect-[2/3] rounded-lg"></div>
    </div>
    <!-- Details Skeleton -->
    <div class="flex-1">
      <div class="skeleton skeleton-text h-8 w-3/4 mb-2"></div>
      <div class="skeleton skeleton-text h-5 w-1/2 mb-4"></div>
      <div class="skeleton skeleton-text w-24 mb-6"></div>
      <div class="space-y-3">
        <div class="skeleton skeleton-text w-full"></div>
        <div class="skeleton skeleton-text w-full"></div>
        <div class="skeleton skeleton-text w-2/3"></div>
      </div>
    </div>
  </div>
</div>

<!-- Book Content -->
<div id="book-content" class="hidden max-w-6xl mx-auto px-4 py-6">
  <div class="flex flex-col md:flex-row md:gap-8">
    <!-- Left Column: Cover -->
    <div class="md:w-72 flex-shrink-0 mb-6 md:mb-0">
      <div id="cover-container" class="aspect-[2/3] bg-gray-100 rounded-lg overflow-hidden relative cover-shadow">
        <!-- Loading spinner (shown while image loads) -->
        <div id="cover-loading" class="hidden absolute inset-0 flex items-center justify-center bg-gray-100">
          <div class="w-8 h-8 border-3 border-gray-300 border-t-primary rounded-full animate-spin"></div>
        </div>
        <div id="cover-placeholder" class="w-full h-full flex items-center justify-center text-gray-300">
          <i data-lucide="book" class="w-16 h-16" aria-hidden="true"></i>
        </div>
        <img id="cover-image" src="" alt="" class="hidden w-full h-full object-cover" />
      </div>
    </div>

    <!-- Right Column: Book Details -->
    <div class="flex-1 space-y-6">
      <!-- Title & Author -->
      <div>
        <h1 id="book-title" class="text-2xl md:text-3xl font-bold text-gray-900"></h1>
        <a id="book-author" href="#" class="inline-flex items-center gap-1 text-lg text-primary mt-1 hover:underline">
          <span id="book-author-name"></span>
          <i data-lucide="arrow-right" class="w-4 h-4"></i>
        </a>
      </div>

      <!-- Rating -->
      <div id="rating-section" class="hidden">
        <div id="rating-stars" class="rating-stars flex gap-0.5"></div>
      </div>

      <!-- Reading Status -->
      <div id="status-section" class="hidden">
        <span
          id="reading-status"
          class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium"
        ></span>
      </div>

      <!-- Genres -->
      <div id="genres-section" class="hidden">
        <div id="genre-badges" class="flex flex-wrap gap-2"></div>
      </div>

      <!-- Series -->
      <div id="series-section" class="hidden">
        <h2 class="font-semibold text-gray-700 mb-3 flex items-center gap-2 text-base">
          <i data-lucide="library" class="w-4 h-4"></i>
          <span id="series-title">Series</span>
        </h2>
        <div id="series-books" class="space-y-1"></div>
        <a
          id="series-view-all"
          href="#"
          class="hidden inline-flex items-center gap-1 text-sm text-primary hover:underline mt-2"
        >
          View all in series
          <i data-lucide="arrow-right" class="w-3 h-3"></i>
        </a>
      </div>

      <!-- Metadata -->
      <div id="metadata-section">
        <dl class="grid grid-cols-2 gap-x-4 gap-y-3 text-sm">
          <div id="isbn-row" class="hidden">
            <dt class="text-gray-500">ISBN</dt>
            <dd id="book-isbn" class="font-medium text-gray-900"></dd>
          </div>
          <div id="pages-row" class="hidden">
            <dt class="text-gray-500">Pages</dt>
            <dd id="book-pages" class="font-medium text-gray-900"></dd>
          </div>
          <div id="format-row" class="hidden">
            <dt class="text-gray-500">Format</dt>
            <dd id="book-format" class="font-medium text-gray-900"></dd>
          </div>
          <div id="publisher-row" class="hidden">
            <dt class="text-gray-500">Publisher</dt>
            <dd id="book-publisher" class="font-medium text-gray-900"></dd>
          </div>
          <div id="published-row" class="hidden">
            <dt class="text-gray-500">Published</dt>
            <dd id="book-published" class="font-medium text-gray-900"></dd>
          </div>
          <div id="added-row" class="hidden">
            <dt class="text-gray-500">Added</dt>
            <dd id="book-added" class="font-medium text-gray-900"></dd>
          </div>
          <div id="modified-row" class="hidden">
            <dt class="text-gray-500">Modified</dt>
            <dd id="book-modified" class="font-medium text-gray-900"></dd>
          </div>
        </dl>
      </div>

      <!-- Reading History -->
      <div id="reading-history-section" class="hidden">
        <h2 class="font-semibold text-gray-700 mb-3 flex items-center gap-2 text-base">
          <i data-lucide="book-open" class="w-4 h-4"></i>
          Reading History
        </h2>
        <div id="reading-history" class="space-y-2"></div>
      </div>

      <!-- Notes -->
      <div id="notes-section" class="hidden">
        <h2 class="font-semibold text-gray-700 mb-2 flex items-center gap-2 text-base">
          <i data-lucide="sticky-note" class="w-4 h-4"></i>
          Notes
        </h2>
        <div id="book-notes" class="bg-gray-50 rounded-lg p-4 text-gray-700 whitespace-pre-wrap"></div>
      </div>

      <!-- Book Images Gallery -->
      <div id="images-section" class="hidden">
        <h2 class="font-semibold text-gray-700 mb-3 flex items-center gap-2 text-base">
          <i data-lucide="images" class="w-4 h-4"></i>
          Photos
        </h2>
        <div id="images-gallery" class="grid grid-cols-3 sm:grid-cols-4 gap-3"></div>
      </div>
    </div>
  </div>
</div>

<!-- Image Lightbox -->
<div
  id="lightbox"
  class="hidden fixed inset-0 bg-black/95 z-50 flex items-center justify-center"
  role="dialog"
  aria-modal="true"
  aria-labelledby="lightbox-title"
>
  <!-- Screen reader announcements -->
  <div id="lightbox-announcer" class="sr-only" aria-live="polite" aria-atomic="true"></div>
  <h2 id="lightbox-title" class="sr-only">Image viewer</h2>

  <!-- Close button -->
  <button
    id="lightbox-close"
    class="absolute top-4 right-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center z-10 lightbox-controls-enter"
    aria-label="Close image viewer"
  >
    <i data-lucide="x" class="w-6 h-6"></i>
  </button>

  <!-- Counter -->
  <div
    id="lightbox-counter"
    class="absolute top-4 left-4 text-white/80 text-sm font-medium px-3 py-1.5 bg-black/30 rounded-full lightbox-controls-enter"
    aria-hidden="true"
  ></div>

  <!-- Previous button (hidden by default, shown if multiple images) -->
  <button
    id="lightbox-prev"
    class="hidden absolute left-4 top-1/2 -translate-y-1/2 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center z-10"
    aria-label="Previous image"
  >
    <i data-lucide="chevron-left" class="w-8 h-8"></i>
  </button>

  <!-- Image container -->
  <div
    id="lightbox-content"
    class="max-w-full max-h-full p-4 flex items-center justify-center transition-transform duration-200 ease-out"
  >
    <div id="lightbox-loading" class="hidden">
      <div class="w-10 h-10 border-3 border-white/30 border-t-white rounded-full animate-spin"></div>
    </div>
    <img
      id="lightbox-image"
      src=""
      alt=""
      class="max-w-full max-h-[90vh] object-contain rounded-xl lightbox-image-glow"
    />
  </div>

  <!-- Next button (hidden by default, shown if multiple images) -->
  <button
    id="lightbox-next"
    class="hidden absolute right-4 top-1/2 -translate-y-1/2 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center z-10"
    aria-label="Next image"
  >
    <i data-lucide="chevron-right" class="w-8 h-8"></i>
  </button>

  <!-- Swipe hint (mobile) -->
  <div
    id="lightbox-swipe-hint"
    class="hidden absolute bottom-8 left-1/2 -translate-x-1/2 text-white/60 text-sm flex items-center gap-2 md:hidden"
  >
    <i data-lucide="chevron-down" class="w-4 h-4 lightbox-swipe-hint"></i>
    <span>Swipe down to close</span>
  </div>
</div>

<!-- Move to Bin Confirmation Bottom Sheet -->
<div
  id="delete-modal"
  class="hidden fixed inset-0 bg-black/50 z-50 md:p-4"
  role="dialog"
  aria-modal="true"
  aria-label="Move to bin confirmation"
>
  <div class="bottom-sheet-content bg-white w-full md:max-w-sm p-6 md:mx-auto">
    <div class="bottom-sheet-handle md:hidden"></div>
    <h3 class="text-lg font-semibold mb-2">Move to Bin?</h3>
    <p class="text-gray-500 mb-4">
      This book will be moved to the bin and automatically deleted after 30 days. You can restore it from Settings.
    </p>
    <!-- Series deletion option (hidden by default, shown when last book in series) -->
    <div id="delete-series-option" class="hidden mb-4 p-3 bg-purple-50 border border-purple-200 rounded-lg">
      <label for="delete-series-checkbox" class="flex items-start gap-3 cursor-pointer">
        <input
          type="checkbox"
          id="delete-series-checkbox"
          class="mt-1 w-4 h-4 text-purple-600 rounded border-gray-300 focus:ring-purple-500"
        />
        <div class="text-sm">
          <span class="font-medium text-purple-900">Also delete the empty series</span>
          <p id="delete-series-name" class="text-purple-700 mt-0.5"></p>
        </div>
      </label>
    </div>
    <div class="flex gap-3">
      <button
        id="cancel-delete"
        class="flex-1 py-2 px-4 border border-gray-300 rounded-lg hover:bg-gray-50 min-h-[44px]"
      >
        Cancel
      </button>
      <button
        id="confirm-delete"
        class="flex-1 py-2 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 min-h-[44px]"
      >
        Move to Bin
      </button>
    </div>
  </div>
</div>

<!-- Toast -->
<div
  id="toast"
  class="hidden fixed bottom-6 left-4 right-4 sm:left-auto sm:right-4 sm:w-80 bg-gray-800 text-white px-4 py-3 rounded-lg shadow-lg z-50"
></div>
