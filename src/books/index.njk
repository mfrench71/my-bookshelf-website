---
layout: base.njk
title: My Books
scripts: '<script type="module" src="/js/books/index.js"></script>'
---
<!-- Sort & Filter Controls -->
<div class="bg-white border-b border-gray-200 sticky top-14 z-30">
  <div class="max-w-6xl mx-auto px-4 py-3">
    <div class="flex flex-col gap-2 md:flex-row md:items-center md:gap-3">
      <!-- Sort -->
      <div class="flex-1 md:flex-none md:w-48">
        <select id="sort-select"
          class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none cursor-pointer">
          <option value="createdAt-desc">Date Added (Newest)</option>
          <option value="createdAt-asc">Date Added (Oldest)</option>
          <option value="title-asc">Title (A-Z)</option>
          <option value="title-desc">Title (Z-A)</option>
          <option value="author-asc">Author (A-Z)</option>
          <option value="author-desc">Author (Z-A)</option>
          <option value="rating-desc">Rating (High-Low)</option>
          <option value="rating-asc">Rating (Low-High)</option>
        </select>
      </div>
      <!-- Filters -->
      <div class="flex items-center gap-2 flex-1 md:flex-none">
        <div class="flex-1 md:flex-none">
          <select id="rating-filter"
            class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none cursor-pointer">
            <option value="0">All Ratings</option>
            <option value="5">5 Stars</option>
            <option value="4">4+ Stars</option>
            <option value="3">3+ Stars</option>
            <option value="2">2+ Stars</option>
            <option value="1">1+ Stars</option>
          </select>
        </div>
        <div class="flex-1 md:flex-none">
          <select id="genre-filter"
            class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none cursor-pointer">
            <option value="">All Genres</option>
          </select>
        </div>
        <div class="flex-1 md:flex-none">
          <select id="status-filter"
            class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none cursor-pointer">
            <option value="">All Status</option>
            <option value="reading">Reading</option>
            <option value="finished">Finished</option>
          </select>
        </div>
        <div class="flex-1 md:flex-none">
          <select id="series-filter"
            class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none cursor-pointer">
            <option value="">All Series</option>
          </select>
        </div>
      </div>
      <!-- Reset Filters -->
      <button id="reset-filters" class="hidden p-2.5 hover:bg-gray-100 rounded-lg text-gray-500 min-w-[44px] min-h-[44px] flex items-center justify-center" aria-label="Reset filters">
        <i data-lucide="x" class="w-5 h-5" aria-hidden="true"></i>
      </button>
    </div>
    <!-- Active Author Filter Badge -->
    <div id="author-filter-badge" class="hidden flex items-center gap-2 mt-2">
      <span class="text-sm text-gray-500">Filtering by author:</span>
      <span class="inline-flex items-center gap-1 px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-medium">
        <span id="author-filter-name"></span>
        <button id="clear-author-filter" class="hover:bg-primary/20 rounded-full p-1.5 min-w-[28px] min-h-[28px] flex items-center justify-center" aria-label="Clear author filter">
          <i data-lucide="x" class="w-4 h-4" aria-hidden="true"></i>
        </button>
      </span>
    </div>
  </div>
</div>

<!-- Pull to Refresh Indicator -->
<div id="pull-indicator" class="hidden overflow-hidden transition-all duration-200">
  <div class="flex items-center justify-center py-3 text-gray-500">
    <i id="pull-icon" data-lucide="arrow-down" class="w-5 h-5 mr-2 transition-transform"></i>
    <span id="pull-text">Pull to refresh</span>
  </div>
</div>

<!-- Main Content -->
<main id="main-content" class="max-w-6xl mx-auto px-4 py-4 pb-24 page-content">
  <!-- Loading State (Skeleton Cards) -->
  <div id="loading-state" class="space-y-3">
    {% for i in range(0, 5) %}
    <div class="skeleton-card">
      <div class="skeleton skeleton-cover"></div>
      <div class="flex-1 min-w-0 py-1">
        <div class="skeleton skeleton-text w-3/4"></div>
        <div class="skeleton skeleton-text w-1/2"></div>
        <div class="skeleton skeleton-text w-1/4 mt-2"></div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Empty State (no books in library) -->
  <div id="empty-state" class="hidden py-12 text-center">
    <i data-lucide="book-open" class="w-16 h-16 text-gray-300 mx-auto"></i>
    <h3 class="text-lg font-medium text-gray-600 mt-4">No books yet</h3>
    <p class="text-gray-400 mt-1">Tap the + button to add your first book</p>
  </div>

  <!-- No Results State (filters active, no matches) -->
  <div id="no-results-state" class="hidden py-12 text-center">
    <i data-lucide="search-x" class="w-16 h-16 text-gray-300 mx-auto"></i>
    <h3 id="no-results-title" class="text-lg font-medium text-gray-600 mt-4">No books match your filters</h3>
    <p class="text-gray-400 mt-1">Try adjusting your filters or <button id="clear-filters-link" class="text-primary hover:underline">clear all filters</button></p>
  </div>

  <!-- Book List -->
  <div id="book-list" class="space-y-3"></div>
</main>

<!-- FAB - Add Book -->
<a href="/books/add/"
  class="fixed bottom-6 right-6 w-14 h-14 bg-primary hover:bg-primary-dark text-white rounded-full shadow-lg flex items-center justify-center transition-colors z-30 fab-press"
  aria-label="Add new book">
  <i data-lucide="plus" class="w-6 h-6" aria-hidden="true"></i>
</a>

<!-- Toast -->
<div id="toast" class="hidden fixed bottom-20 left-4 right-4 sm:left-auto sm:right-4 sm:w-80 bg-gray-800 text-white px-4 py-3 rounded-lg shadow-lg z-50"></div>
